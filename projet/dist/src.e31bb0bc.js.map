{"version":3,"sources":["scripts/viz.js","index.js"],"names":["MARGIN","top","right","bottom","left","SM_WIDTH","SM_HEIGHT","COVID_WIDTH","COVID_HEIGHT","LINE_COLOR","COVID_STROKE_WIDTH","FREQ_STROKE_WIDTH","HOVER_CIRCLE_RADIUS","GRIDLINE_STROKE_WIDTH","GRIDLINE_COLOR","FIRST_INS_DATE","Date","LAST_INS_DATE","dateRange","MIN_DATE_SELECTION_DAYS","selectedDate","mousedownDate","isMouseDown","xScaleSM","yScaleSM","xScaleCov","yScaleCov","covid_data_selected","showAll","DrawCount","data","startDate","endDate","saved","total","forEach","element","Number","athletes","date","d3","select","text","SELECTOR_TO_ATTR","OnGymClosedHover","rect","opacity","attr","DrawCovidViz","dataFermetures","svg","append","scaleTime","domain","extent","d","range","call","axisBottom","scaleLinear","max","Math","cases_moving_avg","yAxis","axisLeft","yAxisGrid","tickSize","tickFormat","g","remove","line","datum","style","area","x","y1","y0","circle","classed","selectAll","enter","start","end","on","mouseover","mousemove","mouseout","mousedown","mouseup","ShowHoverTextAndCircles","dateOfMousPos","invert","mouse","getFullYear","String","getMonth","padStart","getDate","UpdateHover","UpdateTimeWindow","updateSelection","selector","document","getElementById","selection","options","selectedIndex","value","attribute","transition","duration","DrawSmallMultiple","sumstat","nest","key","sport","entries","sort","a","b","sum","values","map","o","moving_avg","reverse","VISIT_THRESHOLD","filter","slice","allKeys","ticks","ceil","filterDateString","y","computeSavedTraining","minDate","min","minDateFormatted","maxDate","maxDateFormatted","saved_trainings","console","log","ShowButton","UpdateHoverSMViz","UpdateHoverCovid","leftDate","rightDate","UpdateTimeSM","find","textOffsetX","textOffsetY","hoverData","xPos","html","parseInt","round","fermeturesGym","csv","then","viz"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"..\\src","sourcesContent":["/* eslint-disable camelcase */\r\n/* eslint-disable indent */\r\n\r\nconst MARGIN = { top: 30, right: 0, bottom: 30, left: 50 }\r\n\r\nconst SM_WIDTH = 275 - MARGIN.left - MARGIN.right\r\nconst SM_HEIGHT = 275 - MARGIN.top - MARGIN.bottom\r\n\r\nconst COVID_WIDTH = 700 - MARGIN.left - MARGIN.right\r\nconst COVID_HEIGHT = 400 - MARGIN.top - MARGIN.bottom\r\n\r\nconst LINE_COLOR = '#E83A14'\r\n\r\nconst COVID_STROKE_WIDTH = 1.5\r\nconst FREQ_STROKE_WIDTH = 1\r\nconst HOVER_CIRCLE_RADIUS = 2\r\n\r\nconst GRIDLINE_STROKE_WIDTH = 0.5\r\nconst GRIDLINE_COLOR = '#C4C4C4'\r\n\r\nvar FIRST_INS_DATE = new Date('2020-06-22')\r\nvar LAST_INS_DATE = new Date('2022-02-12')\r\nvar dateRange = [FIRST_INS_DATE, LAST_INS_DATE]\r\n\r\nconst MIN_DATE_SELECTION_DAYS = 30\r\n\r\nvar selectedDate\r\nvar mousedownDate\r\nvar isMouseDown = false\r\n\r\nvar xScaleSM\r\nvar yScaleSM\r\nvar xScaleCov\r\nvar yScaleCov\r\n\r\nvar covid_data_selected = 'cases'\r\n\r\n\r\nvar showAll = false\r\n\r\n/**\r\n * @param data\r\n * @param startDate\r\n * @param endDate\r\n */\r\nexport function DrawCount(data, startDate, endDate) {\r\n    let saved = 0\r\n    let total = 0\r\n    data.forEach(element => {\r\n        total += Number(element.athletes)\r\n        if (startDate <= element.date && element.date <= endDate) {\r\n            saved += Number(element.athletes)\r\n        }\r\n    })\r\n    d3.select('#training-count').text(saved)\r\n    d3.select('#total-training-count').text(`sur ${total}`)\r\n}\r\n\r\n/**\r\n *\r\n */\r\n\r\nconst SELECTOR_TO_ATTR = {\r\n    'cases': 'cases_moving_avg',\r\n    'deaths': 'death_moving_avg',\r\n    'hospitalisations': 'hospi_moving_avg'\r\n}\r\n\r\nfunction OnGymClosedHover(rect, opacity) {\r\n    d3.select(rect).attr('opacity', opacity)\r\n}\r\n\r\n/**\r\n * @param data\r\n * @param startDate\r\n * @param endDate\r\n */\r\nexport function DrawCovidViz(data, dataFermetures, startDate, endDate) {\r\n    var svg = d3.select('#covid-svg')\r\n        .append('svg')\r\n        .attr('width', COVID_WIDTH + MARGIN.left + MARGIN.right)\r\n        .attr('height', COVID_HEIGHT + MARGIN.top + MARGIN.bottom)\r\n        .append('g')\r\n        .attr('transform',\r\n            'translate(' + MARGIN.left + ',' + MARGIN.top + ')')\r\n\r\n    // Add X axis --> it is a date format\r\n    xScaleCov = d3.scaleTime()\r\n        .domain(d3.extent(data, function (d) { return new Date(d.date) }))\r\n        .range([0, COVID_WIDTH])\r\n    svg.append('g')\r\n        .attr('class', 'x-axis')\r\n        .attr('transform', 'translate(0,' + COVID_HEIGHT + ')')\r\n        .call(d3.axisBottom(xScaleCov))\r\n\r\n    // Add Y axis\r\n    yScaleCov = d3.scaleLinear()\r\n        .domain([0, d3.max(data, (d) => Math.max(d.cases_moving_avg))])\r\n        .range([COVID_HEIGHT, 0])\r\n    var yAxis = svg.append('g')\r\n        .attr('class', 'y-axis')\r\n        .call(d3.axisLeft(yScaleCov))\r\n\r\n    // Add Y grid\r\n    const yAxisGrid = d3.axisLeft(yScaleCov).tickSize(-COVID_WIDTH).tickFormat('')\r\n    svg.append('g')\r\n        .attr('class', 'y-axis-grid')\r\n        .attr('color', GRIDLINE_COLOR)\r\n        .attr('stroke-width', GRIDLINE_STROKE_WIDTH)\r\n        .call(yAxisGrid)\r\n        .call(g => g.select(\".domain\").remove());\r\n\r\n    // Add the cases line\r\n    var line = svg.append('path')\r\n        .datum(data)\r\n        .style('pointer-events', 'none')\r\n        .attr('fill', LINE_COLOR)\r\n        .attr('fill-opacity', 0.2)\r\n        .attr('stroke', LINE_COLOR)\r\n        .attr('stroke-width', COVID_STROKE_WIDTH)\r\n        .attr('d', d3.area()\r\n            .x(function (d) { return xScaleCov(new Date(d.date)) })\r\n            .y1(function (d) { return yScaleCov(d.cases_moving_avg) })\r\n            .y0(yScaleCov(0))\r\n        )\r\n\r\n    // Create the circle that travels along the curve of chart\r\n    var circle = svg.append('g')\r\n        .append('circle')\r\n        .datum(data)\r\n        .classed('hover-circle_covid', true)\r\n        .style('fill', LINE_COLOR)\r\n        .attr('r', 3)\r\n        .style('opacity', 0)\r\n\r\n    // Create the text that travels along the curve of chart\r\n    var text = svg.append('g')\r\n        .append('text')\r\n        .datum(data)\r\n        .classed('hover-text_covid', true)\r\n        .style('opacity', 0)\r\n        .attr('text-anchor', 'left')\r\n        .attr('alignment-baseline', 'middle')\r\n        .style('font-weight', 'bold')\r\n\r\n    // Add closed gyms\r\n    svg.append('g')\r\n        .classed('fermetures_gym', true)\r\n        .selectAll('rect')\r\n        .data(dataFermetures)\r\n        .enter()\r\n        .append('rect')\r\n        .attr('x', element => xScaleCov(element.start))\r\n        .attr('y', COVID_HEIGHT + 1)\r\n        .attr('width', element => xScaleCov(element.end) - xScaleCov(element.start))\r\n        .attr('height', 8)\r\n        .attr('fill', 'yellow')\r\n        .attr('opacity', 0.35)\r\n        .on('mouseover', function () { OnGymClosedHover(this, 0.85) })\r\n        .on('mouseout', function () { OnGymClosedHover(this, 0.35) })\r\n\r\n    // Event listeners\r\n    svg.append('rect')\r\n        .datum(data)\r\n        .style('fill', 'none')\r\n        .style('pointer-events', 'all')\r\n        .attr('y', 30)\r\n        .attr('width', COVID_WIDTH)\r\n        .attr('height', COVID_HEIGHT - 30)\r\n        .attr('id', 'covid')\r\n        .on('mouseover', mouseover)\r\n        .on('mousemove', function (d) { mousemove(this, d) })\r\n        .on('mouseout', mouseout)\r\n        .on('mousedown', function (d) { mousedown(this, d) })\r\n        .on('mouseup', mouseup)\r\n\r\n    // ceate time windows\r\n    svg.append('rect')\r\n        .style('pointer-events', 'none')\r\n        .style('fill', GRIDLINE_COLOR)\r\n        .style('opacity', 0.4)\r\n        .attr('class', 'time-window-left')\r\n        .attr('height', COVID_HEIGHT)\r\n        .attr('width', xScaleCov(dateRange[0]))\r\n    svg.append('rect')\r\n        .style('pointer-events', 'none')\r\n        .style('fill', GRIDLINE_COLOR)\r\n        .style('opacity', 0.4)\r\n        .attr('x', COVID_WIDTH)\r\n        .attr('class', 'time-window-right')\r\n        .attr('height', COVID_HEIGHT)\r\n        .attr('x', xScaleCov(LAST_INS_DATE))\r\n        .attr('width', COVID_WIDTH - xScaleCov(dateRange[1]))\r\n\r\n    // What happens when the mouse move -> show the annotations at the right positions.\r\n    /**\r\n     *\r\n     */\r\n    function mouseover() {\r\n        ShowHoverTextAndCircles(1)\r\n    }\r\n\r\n    /**\r\n     * @param rect\r\n     * @param d\r\n     */\r\n    function mousemove(rect) {\r\n        // recover coordinate we need\r\n        var dateOfMousPos = xScaleCov.invert(d3.mouse(rect)[0])\r\n        selectedDate = `${dateOfMousPos.getFullYear()}-${String(dateOfMousPos.getMonth() + 1).padStart(2, '0')}-${String(dateOfMousPos.getDate()).padStart(2, '0')}`\r\n        UpdateHover()\r\n\r\n        if (isMouseDown) {\r\n            UpdateTimeWindow()\r\n        }\r\n    }\r\n\r\n    function mouseout() {\r\n        ShowHoverTextAndCircles(0)\r\n        isMouseDown = false\r\n    }\r\n\r\n    function mouseup() {\r\n        isMouseDown = false\r\n    }\r\n    function mousedown(rect) {\r\n        var dateOfMousPos = xScaleCov.invert(d3.mouse(rect)[0])\r\n        mousedownDate = `${dateOfMousPos.getFullYear()}-${String(dateOfMousPos.getMonth() + 1).padStart(2, '0')}-${String(dateOfMousPos.getDate()).padStart(2, '0')}`\r\n        isMouseDown = true\r\n    }\r\n\r\n    function updateSelection() {\r\n        var selector = document.getElementById('covid_data_select')\r\n        var selection = selector.options[selector.selectedIndex].value\r\n\r\n        var attribute = SELECTOR_TO_ATTR[selection]\r\n\r\n        // update scale\r\n        yScaleCov = d3.scaleLinear()\r\n            .domain([0, d3.max(data, (d) => Math.max(d[attribute]))])\r\n            .range([COVID_HEIGHT, 0])\r\n\r\n        // update line\r\n        line\r\n            .datum(data)\r\n            .transition()\r\n            .duration(500)\r\n            .attr('d', d3.area()\r\n                .x(function (d) { return xScaleCov(new Date(d.date)) })\r\n                .y1(function (d) { return yScaleCov(d[attribute]) })\r\n                .y0(yScaleCov(0))\r\n            )\r\n\r\n        // update axis\r\n        yAxis\r\n            .transition()\r\n            .duration(500)\r\n            .call(d3.axisLeft(yScaleCov))\r\n    }\r\n\r\n    d3.select(\"#covid_data_select\").on(\"change\", updateSelection)\r\n}\r\n\r\n/**\r\n * @param data\r\n * @param startDate\r\n * @param endDate\r\n */\r\nexport function DrawSmallMultiple(data, startDate, endDate) {\r\n    // group the data: I want to draw one line per group\r\n    var sumstat = d3.nest() // nest function allows to group the calculation per level of a factor\r\n        .key(function (d) { return d.sport })\r\n        .entries(data)\r\n\r\n    // Order by frequency\r\n    sumstat.sort(\r\n        (a, b) =>\r\n            d3.sum(a.values.map(o => o.moving_avg)) -\r\n            d3.sum(b.values.map(o => o.moving_avg))\r\n    ).reverse()\r\n\r\n    // Limit minimum number of visits\r\n    const VISIT_THRESHOLD = 100\r\n    sumstat = sumstat.filter(\r\n        (a) =>\r\n            d3.sum(a.values.map(o => o.moving_avg)) > VISIT_THRESHOLD\r\n    )\r\n\r\n    // Only show some parts of the graph\r\n    if (!showAll) {\r\n        sumstat = sumstat.slice(0, 4)\r\n    }\r\n\r\n    // What is the list of groups?\r\n    const allKeys = sumstat.map(function (d) { return d.key })\r\n\r\n    // Add an svg element for each group. The will be one beside each other and will go on the next row when no more room available\r\n    var svg = d3.select('#smallMultiple-svg')\r\n        .selectAll('uniqueChart')\r\n        .data(sumstat)\r\n        .enter()\r\n        .append('svg')\r\n        .attr('width', SM_WIDTH + MARGIN.left + MARGIN.right)\r\n        .attr('height', SM_HEIGHT + MARGIN.top + MARGIN.bottom)\r\n        .append('g')\r\n        .attr('transform',\r\n            'translate(' + MARGIN.left + ',' + MARGIN.top + ')')\r\n\r\n    // Add X axis --> it is a date format\r\n    xScaleSM = d3.scaleTime()\r\n        .domain(dateRange)\r\n        .range([0, SM_WIDTH])\r\n    svg.append('g')\r\n        .attr('class', 'x-axis-small-multiple')\r\n        .attr('transform', 'translate(0,' + SM_HEIGHT + ')')\r\n        .call(d3.axisBottom(xScaleSM).ticks(2))\r\n\r\n    // Add Y axis\r\n    yScaleSM = d3.scaleLinear()\r\n        .domain([0, Math.ceil(d3.max(data, function (d) { return +d.moving_avg }) / 10) * 10])\r\n        .range([SM_HEIGHT, 0])\r\n    svg.append('g')\r\n        .attr('class', 'y-axis')\r\n        .call(d3.axisLeft(yScaleSM).ticks(5))\r\n\r\n    // Add Y grid\r\n    const yAxisGrid = d3.axisLeft(yScaleSM).tickSize(-SM_WIDTH).tickFormat('').ticks(5)\r\n    svg.append('g')\r\n        .attr('class', 'y-axis-grid')\r\n        .attr('color', GRIDLINE_COLOR)\r\n        .attr('stroke-width', GRIDLINE_STROKE_WIDTH)\r\n        .call(yAxisGrid)\r\n        .call(g => g.select(\".domain\").remove());\r\n\r\n    // Draw the line\r\n    function filterDateString(d) {\r\n        var date = new Date(d.date);\r\n        return dateRange[0] <= date & date <= dateRange[1]\r\n    }\r\n    svg.append('path')\r\n        .attr('class', 'small-multiple-line')\r\n        .style('pointer-events', 'none')\r\n        .attr('stroke', LINE_COLOR)\r\n        .attr('fill', 'none')\r\n        .attr('stroke-width', FREQ_STROKE_WIDTH)\r\n        .attr('d', function (d) {\r\n            return d3.line()\r\n                .x(function (d) { return xScaleSM(new Date(d.date)) })\r\n                .y(function (d) { return yScaleSM(+d.moving_avg) })\r\n                (d.values.filter((d) => filterDateString(d)))\r\n        })\r\n\r\n    // Create even listener\r\n    svg.append('rect')\r\n        .style('fill', 'none')\r\n        .style('pointer-events', 'all')\r\n        .attr('width', SM_WIDTH)\r\n        .attr('height', SM_HEIGHT)\r\n        .attr('id', function (d) { return d.key })\r\n        .on('mouseover', mouseover)\r\n        .on('mousemove', function (d) { mousemove(this, d) })\r\n        .on('mouseout', mouseout)\r\n\r\n    // Create the circle that travels along the curve of chart\r\n    svg.append('g')\r\n        .append('circle')\r\n        .classed('hover-circle', true)\r\n        .style('fill', LINE_COLOR)\r\n        .attr('r', HOVER_CIRCLE_RADIUS)\r\n        .style('opacity', 0)\r\n\r\n    // Create the text that travels along the curve of chart\r\n    var text = svg.append('g')\r\n        .style('pointer-events', 'none')\r\n    text.append('rect')\r\n        .classed('hover-text-bg', true)\r\n        .style('opacity', 0)\r\n        .attr('width', 50)\r\n        .attr('height', 40)\r\n        .attr('fill', '#EFEFEF')\r\n    text.append('rect')\r\n        .classed('hover-x-axis-line', true)\r\n        .style('opacity', 0)\r\n        .attr('width', 1)\r\n        .attr('fill', '#b5b5b5')\r\n        .attr('y', SM_HEIGHT)\r\n    text.append('text')\r\n        .classed('hover-text', true)\r\n        .style('opacity', 0)\r\n        .attr('text-anchor', 'left')\r\n        .attr('alignment-baseline', 'middle')\r\n        .style('font-weight', 'bold')\r\n\r\n\r\n    // What happens when the mouse move -> show the annotations at the right positions.\r\n    /**\r\n     *\r\n     */\r\n    function mouseover() {\r\n        ShowHoverTextAndCircles(1)\r\n    }\r\n\r\n    /**\r\n     * @param rect\r\n     * @param d\r\n     */\r\n    function mousemove(rect) {\r\n        // recover coordinate we need\r\n        var dateOfMousPos = xScaleSM.invert(d3.mouse(rect)[0])\r\n        selectedDate = `${dateOfMousPos.getFullYear()}-${String(dateOfMousPos.getMonth() + 1).padStart(2, '0')}-${String(dateOfMousPos.getDate()).padStart(2, '0')}`\r\n        UpdateHover()\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    function mouseout() {\r\n        ShowHoverTextAndCircles(0)\r\n    }\r\n\r\n    // Add title\r\n    svg.append('text')\r\n        .attr('text-anchor', 'start')\r\n        .attr('y', -5)\r\n        .attr('x', 0)\r\n        .attr('font-size', 14)\r\n        .attr('font-weight', 'bold')\r\n        .classed('sm-title', true)\r\n        .text(function (d) { return (d.key) })\r\n\r\n    // Add counter\r\n    svg.append('text')\r\n        .attr('id', function(d) {return `${d.key}-counter` })\r\n        .attr('text-anchor', 'start')\r\n        .attr('y', -10)\r\n        .attr('x', SM_WIDTH - 38)\r\n        .attr('font-size', 10)\r\n        .classed('sm-title', true)\r\n        .text(\"100\") // A définir la valeur que ça doit prendre\r\n\r\n    // Add subtitle\r\n    svg.append('text')\r\n        .attr('text-anchor', 'start')\r\n        .attr('y', -1)\r\n        .attr('x', SM_WIDTH - MARGIN.right - MARGIN.left - 16)\r\n        .attr('font-size', 10)\r\n        .classed('sm-title', true)\r\n        .text(\"entraî. sauvés\")\r\n\r\n    function computeSavedTraining(data){\r\n        let minDate = d3.min(xScaleSM.ticks())\r\n        let minDateFormatted = `${minDate.getFullYear()}-${String(minDate.getMonth() + 1).padStart(2, '0')}-${String(minDate.getDate()).padStart(2, '0')}`\r\n        \r\n        let maxDate = d3.max(xScaleSM.ticks())\r\n        let maxDateFormatted = `${maxDate.getFullYear()}-${String(maxDate.getMonth() + 1).padStart(2, '0')}-${String(maxDate.getDate()).padStart(2, '0')}`\r\n        \r\n\r\n        // Pour chaque sport, on refait ça ICIIII\r\n        //sport_dict = {}\r\n        //data.forEach(element => {\r\n        //    if (!sport_dict.hasOwnProprerty(element.sport)) {\r\n        //        print(coucou)\r\n        //    } \r\n        //})\r\n        let saved_trainings = 0\r\n\r\n        data.forEach(element => {\r\n            if (minDateFormatted <= element.date && element.date <= maxDateFormatted ) { //&& element.sport == sport_name\r\n                saved_trainings += Number(element.athletes)\r\n            }\r\n        })\r\n        \r\n        console.log(saved_trainings)\r\n        \r\n        d3.select(\"#Judo-counter\").text(saved_trainings)\r\n\r\n\r\n    }\r\n\r\n    computeSavedTraining(data)\r\n\r\n    d3.select('button').on('click', () => ShowButton(data))\r\n}\r\n\r\nfunction ShowButton(data) {\r\n    showAll = !showAll\r\n    if (showAll) {\r\n        d3.select('button').text('Cacher')\r\n    } else {\r\n        d3.select('button').text('Tout Montrer')\r\n    }\r\n    d3.select('#smallMultiple-svg').selectAll('svg').remove()\r\n    DrawSmallMultiple(data, null, null)\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction UpdateHover() {\r\n    d3.select('#hover-date').text('hovered date: ' + selectedDate)\r\n    UpdateHoverSMViz()\r\n    UpdateHoverCovid()\r\n}\r\n\r\nfunction UpdateTimeWindow() {\r\n    var a = new Date(mousedownDate)\r\n    var b = new Date(selectedDate)\r\n    var leftDate = a < b ? a : b\r\n    var rightDate = a > b ? a : b\r\n\r\n    if (leftDate < FIRST_INS_DATE) {\r\n        leftDate = FIRST_INS_DATE\r\n    }\r\n    if (rightDate > LAST_INS_DATE) {\r\n        rightDate = LAST_INS_DATE\r\n    }\r\n\r\n    dateRange = [leftDate, rightDate]\r\n\r\n    d3.select('.time-window-left')\r\n        .attr('width', xScaleCov(leftDate))\r\n    d3.select('.time-window-right')\r\n        .attr('x', xScaleCov(rightDate))\r\n        .attr('width', COVID_WIDTH - xScaleCov(rightDate))\r\n\r\n    UpdateTimeSM()\r\n}\r\n\r\nfunction UpdateTimeSM() {\r\n    // update xScale\r\n    xScaleSM.domain(dateRange)\r\n\r\n    // update xaxis\r\n    d3.selectAll('.x-axis-small-multiple')\r\n        .transition()\r\n        .duration(5)\r\n        .call(d3.axisBottom(xScaleSM).ticks(2))\r\n\r\n    // update line\r\n    function filterDateString(d) {\r\n        var date = new Date(d.date);\r\n        return dateRange[0] <= date & date <= dateRange[1]\r\n    }\r\n    d3.selectAll('.small-multiple-line')\r\n        .transition().duration(5).attr('d', function (d) {\r\n            return d3.line()\r\n                .x(function (d) { return xScaleSM(new Date(d.date)) })\r\n                .y(function (d) { return yScaleSM(+d.moving_avg) })\r\n                (d.values.filter((d) => filterDateString(d)))\r\n        })\r\n}\r\n\r\n\r\n\r\n/**\r\n *\r\n */\r\nfunction UpdateHoverSMViz() {\r\n    d3.selectAll('.hover-circle')\r\n        .attr('cx', data => xScaleSM(new Date(data.values.find(element => element.date === selectedDate).date)))\r\n        .attr('cy', data => yScaleSM(data.values.find(element => element.date === selectedDate).moving_avg))\r\n\r\n    d3.selectAll('.hover-x-axis-line')\r\n        .attr('x', data => xScaleSM(new Date(data.values.find(element => element.date === selectedDate).date)))\r\n        .attr('y', data => yScaleSM(data.values.find(element => element.date === selectedDate).moving_avg))\r\n        .attr('height', data => SM_HEIGHT - yScaleSM(data.values.find(element => element.date === selectedDate).moving_avg))\r\n\r\n    const textOffsetX = 10\r\n    const textOffsetY = 20\r\n\r\n    d3.selectAll('.hover-text')\r\n        .attr('x', function (data) {\r\n            const hoverData = data.values.find(element => element.date === selectedDate)\r\n            const xPos = xScaleSM(new Date(hoverData.date))\r\n            if (xPos > SM_WIDTH / 2) {\r\n                return xPos - 4 * textOffsetX\r\n            } else {\r\n                return xPos + textOffsetX\r\n            }\r\n        })\r\n        .attr('y', function (data) {\r\n            const hoverData = data.values.find(element => element.date === selectedDate)\r\n            return yScaleSM(hoverData.moving_avg) - textOffsetY\r\n        })\r\n        .html(function (data) {\r\n            const hoverData = data.values.find(element => element.date === selectedDate)\r\n            return parseInt(hoverData.moving_avg)\r\n        })\r\n\r\n    d3.selectAll('.hover-text-bg')\r\n        .attr('x', function (data) {\r\n            const hoverData = data.values.find(element => element.date === selectedDate)\r\n            const xPos = xScaleSM(new Date(hoverData.date))\r\n            if (xPos > SM_WIDTH / 2) {\r\n                return xPos - 4 * textOffsetX\r\n            } else {\r\n                return xPos + textOffsetX\r\n            }\r\n        })\r\n        .attr('y', function (data) {\r\n            const hoverData = data.values.find(element => element.date === selectedDate)\r\n            return yScaleSM(hoverData.moving_avg) - textOffsetY - 25\r\n        })\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction UpdateHoverCovid() {\r\n\r\n    var selector = document.getElementById('covid_data_select')\r\n    var selection = selector.options[selector.selectedIndex].value\r\n\r\n    var attribute = SELECTOR_TO_ATTR[selection]\r\n\r\n    d3.select('.hover-circle_covid')\r\n        .attr('cx', data => xScaleCov(new Date(data.find(element => element.date === selectedDate).date)))\r\n        .attr('cy', data => yScaleCov(data.find(element => element.date === selectedDate)[attribute]))\r\n    const textOffsetX = 10\r\n    const textOffsetY = 20\r\n\r\n    d3.selectAll('.hover-text_covid')\r\n        .attr('x', function (data) {\r\n            const hoverData = data.find(element => element.date === selectedDate)\r\n            const xPos = xScaleCov(new Date(hoverData.date))\r\n            if (xPos > SM_WIDTH / 2) {\r\n                return xPos - 4 * textOffsetX\r\n            } else {\r\n                return xPos + textOffsetX\r\n            }\r\n        })\r\n        .attr('y', function (data) {\r\n            const hoverData = data.find(element => element.date === selectedDate)\r\n            return yScaleCov(hoverData[attribute]) - textOffsetY\r\n        })\r\n        .html(function (data) {\r\n            const hoverData = data.find(element => element.date === selectedDate)\r\n            return Math.round(hoverData[attribute])\r\n        })\r\n\r\n\r\n}\r\n\r\n/**\r\n * @param opacity\r\n */\r\nfunction ShowHoverTextAndCircles(opacity) {\r\n    d3.selectAll('.hover-text').style('opacity', opacity)\r\n    d3.selectAll('.hover-text-bg').style('opacity', opacity)\r\n    d3.selectAll('.hover-x-axis-line').style('opacity', opacity)\r\n    d3.selectAll('.hover-circle').style('opacity', opacity)\r\n    d3.selectAll('.hover-text_covid').style('opacity', opacity)\r\n    d3.selectAll('.hover-circle_covid').style('opacity', opacity)\r\n\r\n    if (opacity === 0) {\r\n        d3.select('#hover-date').text('hovered date:')\r\n    }\r\n}\r\n","/* eslint-disable indent */\r\n'use strict'\r\n\r\n// import d3Tip from 'd3-tip'\r\nimport * as viz from './scripts/viz.js'\r\n\r\n/**\r\n * @file This file is the entry-point for the the code for the Project for the course INF8808.\r\n * @author Matthieu Beaud ...\r\n * @version v1.0.0\r\n */\r\n\r\nconst fermeturesGym = [\r\n    { start: new Date('2020-03-15'), end: new Date('2020-06-21') },\r\n    { start: new Date('2020-10-08'), end: new Date('2021-03-21') },\r\n    { start: new Date('2021-04-08'), end: new Date('2021-06-06') },\r\n    { start: new Date('2021-12-20'), end: new Date('2022-02-13') }\r\n]\r\n\r\n// start and end dates to define\r\nconst startDate = new Date(2020, 0, 1)\r\nconst endDate = new Date(2022, 0, 1)\r\n\r\nconsole.log('test');\r\n\r\n(function (d3) {\r\n    d3.csv('./moving_avg_dataset.csv').then(function (data) {\r\n        console.log(data)\r\n        viz.DrawCount(data, startDate, endDate)\r\n        viz.DrawSmallMultiple(data, startDate, endDate)\r\n    })\r\n\r\n    d3.csv('./merged_covid_dataset.csv').then((data) => {\r\n        viz.DrawCovidViz(data, fermeturesGym, startDate, endDate)\r\n    })\r\n})(d3)\r\n"]}